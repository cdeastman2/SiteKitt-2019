Function RequireAdmin {	If (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]"Administrator")) {		Start-Process powershell.exe "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`" $PSCommandArgs" -WorkingDirectory $pwd -Verb RunAs		Exit	}}RequireAdmin###########################################Create Folder#########################################Function Folder1 {if (!(Test-Path C:\Temps))    {        New-Item -ItemType Directory -Path C:\Temps    }	}##########################################Tattoo in Registry#########################################Function ADD-REG {$RegLocations = @("HKLM:\Software\MHS")if([System.Environment]::Is64BitProcess){    $RegLocations += "HKLM:\Software\WOW6432Node\MHS"}foreach($Key in $RegLocations){    if(-not(Test-Path $Key)){	    New-Item -Path 'HKLM:\Software' -Name "MHS" -itemType "Directory" -Force | New-ItemProperty -Path $Key -Name "SchTaskWasCreated" -Value (Get-Date -Format 'M/d/yyyy hh:mm:ss tt') -ErrorAction SilentlyContinue -PropertyType String -Force | Out-Null    }	New-Item 'HKLM:\Software\WOW6432Node\' -Name "MHS" -itemType "Directory" -Force	New-ItemProperty -Path $Key -Name "SchTaskWasCreated" -Value (Get-Date -Format 'M/d/yyyy hh:mm:ss tt') -ErrorAction SilentlyContinue -PropertyType String -Force | Out-Null}}$scriptPath = "C:\Temps\UserProfile.ps1"Function MakeTask {$STAction = New-ScheduledTaskAction -Execute 'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe' -Argument "-ExecutionPolicy Bypass -noprofile -file $scriptPath"$STTrig =  New-ScheduledTaskTrigger -Weekly -WeeksInterval 1 -DaysofWeek Friday -At 8:00am$STSet = New-ScheduledTaskSettingsSet -WakeToRun -AllowStartIfOnBatteriesRegister-ScheduledTask -TaskName "Profile_Delete" -Action $STAction -Trigger $STTrig  -Settings $STSet -Description "This Schedule will delete any user profile with over 30 days of inactivity" -RunLevel Highest  -User System}Function CopyItem {$WebClient = New-Object System.Net.WebClient$WebClient.DownloadFile("\\sccm-data\Software\Schedule_Task\Profile_Script\UserProfile.ps1","C:\Temps\UserProfile.ps1")}ADD-REGFolder1CopyItemMakeTask